{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./board.js","webpack:///./constants.js","webpack:///./main.js","webpack:///./piece.js"],"names":["Board","ctx","ctxNext","init","canvas","width","COLS","BLOCK_SIZE","height","ROWS","scale","grid","getEmptyGrid","piece","Piece","setStartingPosition","getNewPiece","next","clearRect","draw","Array","from","length","fill","p","shape","every","row","dy","value","dx","x","y","insideWalls","aboveFloor","notOccupied","direction","JSON","parse","stringify","forEach","reverse","drawBoard","fillStyle","COLORS","fillRect","moves","KEY","DOWN","valid","move","freeze","clearLines","lines","splice","unshift","account","score","getLinesClearedPoints","LINES_PER_LEVEL","level","time","LEVEL","lineClearPoints","POINTS","SINGLE","DOUBLE","TRIPLE","TETRIS","ESC","SPACE","LEFT","UP","RIGHT","P","Q","Object","SHAPES","SOFT_DROP","HARD_DROP","document","getElementById","getContext","canvasNext","board","requestId","accountValues","updateAccount","key","element","textContent","Proxy","set","target","initNext","play","resetGame","animate","window","reset","start","elapsed","now","drop","gameOver","requestAnimationFrame","cancelAnimationFrame","font","fillText","rotate","addEventListener","e","keyCode","preventDefault","event","spawn","typeId","randomizeTetrominoType","color","noOfTypes","Math","floor","random"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./main.js\");\n","/* for board logic. */\r\nimport Piece from './piece';\r\nimport { COLS, ROWS, BLOCK_SIZE, LINES_PER_LEVEL, KEY, COLORS, POINTS, LEVEL } from './constants';\r\nimport { moves, account, time } from './main';\r\nexport default class Board {\r\n  ctx;\r\n  ctxNext;\r\n  grid;\r\n  piece;\r\n  constructor(ctx, ctxNext) {\r\n    this.ctx = ctx;\r\n    this.ctxNext = ctxNext;\r\n    this.init();\r\n  }\r\n  init() {\r\n    // 상수를 사용하여 캔버스 사이즈를 계산한다.\r\n    this.ctx.canvas.width = COLS * BLOCK_SIZE;\r\n    this.ctx.canvas.height = ROWS * BLOCK_SIZE;\r\n\r\n    // scale은 x,y축으로 N배만큼 확대함. (좌표/길이/선두께 포함)\r\n    this.ctx.scale(BLOCK_SIZE, BLOCK_SIZE);\r\n  }\r\n  reset() {\r\n    // 게임 시작전 보드 초기화\r\n    // return this.getEmptyBoard();\r\n    this.grid = this.getEmptyGrid();\r\n    this.piece = new Piece(this.ctx);\r\n    this.piece.setStartingPosition();\r\n    this.getNewPiece();\r\n  }\r\n\r\n  getNewPiece() {\r\n    this.next = new Piece(this.ctxNext);\r\n    this.ctxNext.clearRect(0, 0, this.ctxNext.canvas.width, this.ctxNext.canvas.height);\r\n    this.next.draw();\r\n  }\r\n  getEmptyGrid() {\r\n    // ROWS * COLS 의 2차원 배열 생성됨.\r\n    // from 이 {length: N}을 넣으면, 길이가 N인 배열을 생성해주고,\r\n    // callback의 return 값을 배열의 각 원소로 초기화해줌.\r\n    return Array.from({ length: ROWS }, () => Array(COLS).fill(0));\r\n  }\r\n  valid(p) {\r\n    return p.shape.every((row, dy) => {\r\n      return row.every((value, dx) => {\r\n        let x = p.x + dx;\r\n        let y = p.y + dy;\r\n        return value === 0 || (this.insideWalls(x) && this.aboveFloor(y) && this.notOccupied(x, y));\r\n      });\r\n    });\r\n  }\r\n  insideWalls(x) {\r\n    return x >= 0 && x < COLS;\r\n  }\r\n  aboveFloor(y) {\r\n    return y <= ROWS;\r\n  }\r\n  notOccupied(x, y) {\r\n    return this.grid[y] && this.grid[y][x] === 0;\r\n  }\r\n  rotate(piece, direction) {\r\n    // Clone with JSON for immutability.\r\n    // spread 연산자로 하면 1 level 밖에 못하니까 아래처럼 함.\r\n    let p = JSON.parse(JSON.stringify(piece));\r\n    // Transpose matrix\r\n    for (let y = 0; y < p.shape.length; ++y) {\r\n      for (let x = 0; x < y; ++x) {\r\n        [p.shape[x][y], p.shape[y][x]] = [p.shape[y][x], p.shape[x][y]];\r\n      }\r\n    }\r\n    p.shape.forEach((row) => row.reverse());\r\n\r\n    return p;\r\n  }\r\n\r\n  draw() {\r\n    this.piece.draw();\r\n    this.drawBoard();\r\n  }\r\n\r\n  drawBoard() {\r\n    this.grid.forEach((row, y) => {\r\n      row.forEach((value, x) => {\r\n        if (value > 0) {\r\n          this.ctx.fillStyle = COLORS[value];\r\n          this.ctx.fillRect(x, y, 1, 1);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  drop() {\r\n    let p = moves[KEY.DOWN](this.piece);\r\n    if (this.valid(p)) {\r\n      this.piece.move(p);\r\n    } else {\r\n      this.freeze();\r\n      this.clearLines();\r\n      if (this.piece.y === 0) {\r\n        // Game over\r\n        return false;\r\n      }\r\n      this.piece = this.next;\r\n      this.piece.ctx = this.ctx;\r\n      this.piece.setStartingPosition();\r\n      this.getNewPiece();\r\n    }\r\n    return true;\r\n  }\r\n  freeze() {\r\n    this.piece.shape.forEach((row, y) => {\r\n      row.forEach((value, x) => {\r\n        if (value > 0) {\r\n          this.grid[y + this.piece.y][x + this.piece.x] = value;\r\n        }\r\n      });\r\n    });\r\n  }\r\n  clearLines() {\r\n    let lines = 0;\r\n\r\n    this.grid.forEach((row, y) => {\r\n      // If every value is greater than 0.\r\n      if (row.every((value) => value > 0)) {\r\n        lines++;\r\n\r\n        // Remove the row.\r\n        this.grid.splice(y, 1);\r\n\r\n        // Add zero filled row at the top.\r\n        this.grid.unshift(Array(COLS).fill(0));\r\n      }\r\n    });\r\n\r\n    if (lines > 0) {\r\n      // Calculate points from cleared lines and level.\r\n      account.score += this.getLinesClearedPoints(lines);\r\n      account.lines += lines;\r\n      // If we have reached the lines for next level\r\n      if (account.lines >= LINES_PER_LEVEL) {\r\n        // Goto next level\r\n        account.level++;\r\n        // Remove lines so we start working for the next level\r\n        account.lines -= LINES_PER_LEVEL;\r\n        // Increase speed of game\r\n        time.level = LEVEL[account.level];\r\n      }\r\n    }\r\n  }\r\n  getLinesClearedPoints(lines, level) {\r\n    const lineClearPoints = lines === 1 ? POINTS.SINGLE : lines === 2 ? POINTS.DOUBLE : lines === 3 ? POINTS.TRIPLE : lines === 4 ? POINTS.TETRIS : 0;\r\n\r\n    return (account.level + 1) * lineClearPoints;\r\n  }\r\n}\r\n","/* where we put the configurations and rules of the game. */\r\nexport const COLS = 10;\r\nexport const ROWS = 20;\r\nexport const BLOCK_SIZE = 30;\r\nexport const LINES_PER_LEVEL = 10;\r\nexport const KEY = {\r\n  // 각 숫자는 keydown이벤트의 keycode 값\r\n  ESC: 27,\r\n  SPACE: 32,\r\n  LEFT: 37,\r\n  UP: 38,\r\n  RIGHT: 39,\r\n  DOWN: 40,\r\n  P: 80,\r\n  Q: 81,\r\n};\r\nObject.freeze(KEY);\r\n\r\nexport const COLORS = ['none', 'cyan', 'blue', 'orange', 'yellow', 'green', 'purple', 'red'];\r\nObject.freeze(COLORS);\r\n\r\nexport const SHAPES = [\r\n  [],\r\n  [\r\n    [0, 0, 0, 0],\r\n    [1, 1, 1, 1],\r\n    [0, 0, 0, 0],\r\n    [0, 0, 0, 0],\r\n  ],\r\n  [\r\n    [2, 0, 0],\r\n    [2, 2, 2],\r\n    [0, 0, 0],\r\n  ],\r\n  [\r\n    [0, 0, 3], // 0,0 -> 2,0 ; 0,1 -> 1,0 ; 0,2 -> 0,0\r\n    [3, 3, 3], // 1,0 -> 2,1 ; 1,1 -> 1,1 ; 1,2 -> 0,1\r\n    [0, 0, 0],\r\n  ], // 2,0 -> 2,2 ; 2,1 -> 1,2 ; 2,2 -> 0,2\r\n  [\r\n    [4, 4],\r\n    [4, 4],\r\n  ],\r\n  [\r\n    [0, 5, 5],\r\n    [5, 5, 0],\r\n    [0, 0, 0],\r\n  ],\r\n  [\r\n    [0, 6, 0],\r\n    [6, 6, 6],\r\n    [0, 0, 0],\r\n  ],\r\n  [\r\n    [7, 7, 0],\r\n    [0, 7, 7],\r\n    [0, 0, 0],\r\n  ],\r\n];\r\nObject.freeze(SHAPES);\r\n\r\nexport const POINTS = {\r\n  SINGLE: 100,\r\n  DOUBLE: 300,\r\n  TRIPLE: 500,\r\n  TETRIS: 800,\r\n  SOFT_DROP: 1,\r\n  HARD_DROP: 2,\r\n};\r\nObject.freeze(POINTS);\r\n\r\nexport const LEVEL = {\r\n  0: 800,\r\n  1: 720,\r\n  2: 630,\r\n  3: 550,\r\n  4: 470,\r\n  5: 380,\r\n  6: 300,\r\n  7: 220,\r\n  8: 130,\r\n  9: 100,\r\n  10: 80,\r\n  11: 80,\r\n  12: 80,\r\n  13: 70,\r\n  14: 70,\r\n  15: 70,\r\n  16: 50,\r\n  17: 50,\r\n  18: 50,\r\n  19: 30,\r\n  20: 30,\r\n  // 29+ is 20ms\r\n};\r\nObject.freeze(LEVEL);\r\n","/* code to initialize the game and the overall game logic. */\r\nimport Board from './board.js';\r\nimport { BLOCK_SIZE, POINTS, KEY, LEVEL } from './constants';\r\nconst canvas = document.getElementById('board');\r\nconst ctx = canvas.getContext('2d');\r\nconst canvasNext = document.getElementById('next');\r\nconst ctxNext = canvasNext.getContext('2d');\r\n\r\nlet board = new Board(ctx, ctxNext);\r\nlet requestId;\r\nexport let time;\r\n\r\nlet accountValues = {\r\n  score: 0,\r\n  level: 0,\r\n  lines: 0,\r\n};\r\n\r\nfunction updateAccount(key, value) {\r\n  let element = document.getElementById(key);\r\n  if (element) {\r\n    element.textContent = value;\r\n  }\r\n}\r\n\r\nexport let account = new Proxy(accountValues, {\r\n  set: (target, key, value) => {\r\n    target[key] = value;\r\n    updateAccount(key, value);\r\n    return true;\r\n  },\r\n});\r\n\r\ninitNext();\r\n\r\nfunction initNext() {\r\n  // Calculate size of canvas from constants.\r\n  ctxNext.canvas.width = 4 * BLOCK_SIZE;\r\n  ctxNext.canvas.height = 4 * BLOCK_SIZE;\r\n  ctxNext.scale(BLOCK_SIZE / 2, BLOCK_SIZE / 2);\r\n  // 샘플코드는 /2 를 안해도 잘 되는데 왜 나는 /2를 해야하는지 모르겠음.\r\n}\r\n\r\nfunction play() {\r\n  resetGame();\r\n  animate();\r\n}\r\nwindow.play = play;\r\n\r\nfunction resetGame() {\r\n  account.score = 0;\r\n  account.lines = 0;\r\n  account.level = 0;\r\n  board.reset();\r\n  time = { start: 0, elapsed: 0, level: LEVEL[account.level] };\r\n}\r\n\r\nfunction animate(now = 0) {\r\n  time.elapsed = now - time.start;\r\n  if (time.elapsed > time.level) {\r\n    time.start = now;\r\n    if (!board.drop()) {\r\n      gameOver();\r\n      return;\r\n    }\r\n  }\r\n\r\n  // Clear board before drawing new state.\r\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\r\n\r\n  board.draw();\r\n  requestId = requestAnimationFrame(animate);\r\n}\r\n\r\nfunction gameOver() {\r\n  cancelAnimationFrame(requestId);\r\n  ctx.fillStyle = 'black';\r\n  ctx.fillRect(1, 3, 8, 1.2);\r\n  ctx.font = '1px Arial';\r\n  ctx.fillStyle = 'red';\r\n  ctx.fillText('GAME OVER', 1.8, 4);\r\n}\r\n\r\nexport const moves = {\r\n  // p : piece 클래스 인스턴스\r\n  // p.x, p.y : block의 x,y축 좌표\r\n  [KEY.LEFT]: (p) => ({ ...p, x: p.x - 1 }),\r\n  [KEY.RIGHT]: (p) => ({ ...p, x: p.x + 1 }),\r\n  [KEY.DOWN]: (p) => ({ ...p, y: p.y + 1 }),\r\n  [KEY.SPACE]: (p) => ({ ...p, y: p.y + 1 }),\r\n  [KEY.UP]: (p) => board.rotate(p),\r\n};\r\n\r\ndocument.addEventListener('keydown', (e) => {\r\n  if (moves[e.keyCode]) {\r\n    e.preventDefault(); // stop event bubbling\r\n    let p = moves[e.keyCode](board.piece);\r\n    if (e.keyCode === KEY.SPACE) {\r\n      while (board.valid(p)) {\r\n        // hard drop\r\n        account.score += POINTS.HARD_DROP;\r\n        board.piece.move(p);\r\n        p = moves[KEY.DOWN](board.piece);\r\n      }\r\n    } else if (board.valid(p)) {\r\n      // block 이동이 가능한 경우. (벽에 안부딪힘)\r\n      board.piece.move(p);\r\n      if (event.keyCode === KEY.DOWN) {\r\n        account.score += POINTS.SOFT_DROP;\r\n      }\r\n    }\r\n    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height); // 이전 모양 지움\r\n    board.piece.draw();\r\n  }\r\n});\r\n","import { COLORS, SHAPES } from './constants';\r\n/* for piece logic. */\r\nexport default class Piece {\r\n  /* \r\n  x : board에서의 x 좌표\r\n  y : board에서의 y 좌표\r\n  color : block 색\r\n  shape : block 을 행렬로 표현한 2차원 배열\r\n  ctx : canvas 객체\r\n  */\r\n  x;\r\n  y;\r\n  color;\r\n  shape;\r\n  ctx;\r\n  typeId;\r\n  constructor(ctx) {\r\n    this.ctx = ctx;\r\n    this.spawn();\r\n  }\r\n  spawn() {\r\n    this.typeId = this.randomizeTetrominoType(COLORS.length - 1);\r\n    this.shape = SHAPES[this.typeId];\r\n    this.color = COLORS[this.typeId];\r\n    // starting position\r\n    this.x = 3;\r\n    this.y = 0;\r\n  }\r\n  draw() {\r\n    this.ctx.fillStyle = this.color;\r\n    this.shape.forEach((row, y) => {\r\n      row.forEach((value, x) => {\r\n        // x, y 는 shape 내에서 블록의 위치\r\n        // this.x + x 는 보드상 블록 위치\r\n        if (value > 0) {\r\n          this.ctx.fillRect(this.x + x, this.y + y, 1, 1);\r\n        }\r\n      });\r\n    });\r\n  }\r\n  move(p) {\r\n    this.x = p.x;\r\n    this.y = p.y;\r\n    this.shape = p.shape;\r\n  }\r\n  randomizeTetrominoType(noOfTypes) {\r\n    return Math.floor(Math.random() * noOfTypes + 1);\r\n  }\r\n  setStartingPosition() {\r\n    this.x = this.typeId === 4 ? 4 : 3;\r\n  }\r\n}\r\n"],"sourceRoot":""}